<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.3"/><style data-href="/my-blog/styles.1a303912f7f327089878.css" data-identity="gatsby-global-css">body{margin:0;padding:0}@font-face{font-family:taebaek;font-style:normal;font-weight:400;src:url(/my-blog/static/TAEBAEK-1f07c3ec4f67d3a56954563d9ccf1ed3.ttf) format("truetype")}@font-face{font-family:taebaek-milkyway;font-style:normal;font-weight:400;src:url(/my-blog/static/TAEBAEK-milkyway-be8807805a66e1365e5da8d62a854d67.ttf) format("truetype")}.ContentsTree-module--contentsTree__leaf--8208d{color:#fff;font-family:Consolas,monospace;font-size:2.5vh;font-weight:700;text-decoration:none}.Home-module--home--eeb12,.Home-module--home__main--2a0a1{display:flex;height:100vh;width:100vw}.Home-module--home__main--2a0a1{align-items:center;background-color:#000;background-image:linear-gradient(to top left,#28283c,#000014);flex-direction:column;justify-content:center}.Home-module--home__main__canvas--36a08{height:100vh;padding:2vh;position:fixed;width:100vw}.Home-module--home__main__titleBox--c2d57{align-items:flex-end;display:flex;flex-direction:column;height:90%;justify-content:flex-end;width:90%}.Home-module--home__main__titleBox__title--c4566{align-items:center;display:flex;flex-direction:column;z-index:1}.Home-module--home__main__titleBox__title__text--d1066,.Home-module--home__main__titleBox__title__text__vibration--cebde{color:#fff;font-family:taebaek;font-size:8vh;font-weight:700;padding-bottom:1vh;padding-top:1vh;z-index:1}.Home-module--home__main__titleBox__title__text__vibration--cebde{animation:Home-module--vibration--c3fd7 .1s infinite}@keyframes Home-module--vibration--c3fd7{0%{transform:rotate(1deg)}to{transform:rotate(-1deg)}}.Home-module--home__main__titleBox__title__contentsTree--7db75{height:0;opacity:0;overflow:hidden;transition:height .3s ease,opacity .5s ease-in}.Home-module--home__main__titleBox__title--c4566:hover>.Home-module--home__main__titleBox__title__contentsTree--7db75{height:55vh;opacity:1}.Home-module--home__main__titleBox__subtitle--05d67{color:#fff;font-family:taebaek-milkyway;font-size:5vh;font-weight:700;padding-bottom:2vh;padding-top:2vh;z-index:1}.Home-module--home__main__titleBox__contact--33deb{color:#fff;font-family:Consolas,monospace;font-size:3vh;font-weight:400;padding-top:1vh;text-decoration-line:none;z-index:1}.Home-module--home__main__titleBox__contact--33deb:hover{text-decoration:underline}.Navigator-module--navigator--6deb4{align-items:flex-start;display:flex;flex-direction:column;justify-content:center;padding-left:2vw;padding-top:2vh;position:fixed}.Navigator-module--navigator__title--3580b{color:#fff;font-family:taebaek;font-size:5vh;font-weight:700;padding-bottom:1vh;padding-top:1vh;text-decoration:none}.Post-module--post--83824{display:flex;justify-content:space-between}.Post-module--post__background--9bfff{background-image:linear-gradient(to top left,#28283c,#000014);height:100vh;position:fixed;width:100vw;z-index:-1}.Post-module--post__content--4d366{align-content:center;align-items:center;height:100%;width:100%}.Post-module--post__content__markdown--f2389{margin-left:30%;width:50%}.Post-module--post__content__markdown__title--f6def{color:#fff;font-size:5vh;font-weight:700;padding-bottom:3vh;padding-top:3vh}.Post-module--post__content__markdown__author--c2fcc,.Post-module--post__content__markdown__date--5506d{color:#fff;font-size:2.5vh;text-align:end}.PostList-module--postList--5fcc0{justify-content:space-between;width:100%}.PostList-module--postList__background--0a42f{background-image:linear-gradient(to top left,#28283c,#000014);height:100vh;position:fixed;width:100vw;z-index:-1}.PostList-module--postList__category--af01a{color:#fff;font-size:5vh;font-weight:700;margin-left:30%;padding-bottom:5vh;padding-left:2vw;padding-top:5vh}.PostList-module--postList__content--99772{align-content:center;align-items:center;margin-left:30%;width:50%}.PostList-module--postList__content__post--c72c0{border-bottom-color:#404040;border-bottom-style:solid;color:#d0d0d0;margin-left:1.5vw;padding-bottom:3vh;padding-top:3vh;width:95%}.PostList-module--postList__content__post__title--43639{color:#fff;font-size:2.5vh;font-weight:700;text-decoration:none}.PostList-module--postList__content__post__title--43639:hover{text-decoration:underline}.PostList-module--postList__content__post__excerpt--23e54{font-size:2vh;font-weight:400;line-height:160%;padding-bottom:2vh;padding-top:2vh}.PostList-module--postList__content__post__author--0fbc7,.PostList-module--postList__content__post__date--1f2f3{font-size:2vh;font-weight:400;text-align:end}</style></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Post-module--post--83824"><nav class="Navigator-module--navigator--6deb4"><a href="https://bill0077.github.io/my-blog" class="Navigator-module--navigator__title--3580b">bill0077.log</a><div><div class="ContentsTree-module--contentsTree__leaf--8208d">  │</div><div class="ContentsTree-module--contentsTree__leaf--8208d">  ├── ProblemSolving</div><div><a href="https://bill0077.github.io/my-blog/boj" class="ContentsTree-module--contentsTree__leaf--8208d">  │     └── boj </a></div><div class="ContentsTree-module--contentsTree__leaf--8208d">  │</div><div class="ContentsTree-module--contentsTree__leaf--8208d">  ├── SideProjects</div><div><a href="https://bill0077.github.io/my-blog/myblog-dev-log" class="ContentsTree-module--contentsTree__leaf--8208d">  │     ├── myblog-dev-log</a></div><div><a href="https://bill0077.github.io/my-blog/tadak-dev-log" class="ContentsTree-module--contentsTree__leaf--8208d">  │     └── tadak-dev-log</a></div><div class="ContentsTree-module--contentsTree__leaf--8208d">  │</div><div class="ContentsTree-module--contentsTree__leaf--8208d">  ├── Study</div><div><a href="https://bill0077.github.io/my-blog/devops" class="ContentsTree-module--contentsTree__leaf--8208d">  │     └── devops</a></div><div class="ContentsTree-module--contentsTree__leaf--8208d">  │</div><div><a href="https://bill0077.github.io/my-blog/etc" class="ContentsTree-module--contentsTree__leaf--8208d">  └── etc</a></div></div></nav><div class="Post-module--post__background--9bfff"></div><div class="Post-module--post__content--4d366"><div class="Post-module--post__content__markdown--f2389"><div class="Post-module--post__content__markdown__title--f6def">개발 블로그 개발기 - 7. react-markdown을 이용해 Post 페이지 제작</div><div class="Post-module--post__content__markdown__author--c2fcc">written by bill0077</div><div class="Post-module--post__content__markdown__date--5506d">date: 2024-02-14</div><p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]"><p style="color:white;display:inline;font-weight:bold" node="[object Object]">Demo: <a to="https://bill0077.github.io/my-blog" style="color:cadetblue;display:inline" href="https://bill0077.github.io/my-blog" node="[object Object]">https://bill0077.github.io/my-blog</a><br/>
Git commit: <a to="https://github.com/bill0077/my-blog/commit/c030623bfdbe6c13103e021cef33d504edbdc7f0" style="color:cadetblue;display:inline" href="https://github.com/bill0077/my-blog/commit/c030623bfdbe6c13103e021cef33d504edbdc7f0" node="[object Object]">https://github.com/bill0077/my-blog/commit/c030623bfdbe6c13103e021cef33d504edbdc7f0</a></p></p>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">현재까지 만든 블로그는 홈과 dummy인 목차와 추천 글 항목만이 있을 뿐이다. 이제 실제로 글을 포스팅 할 수 있도록 구현해보자.</p>
<h1 style="color:white;border-bottom:solid" node="[object Object]">글 페이지 만들기</h1>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">Gatsby를 이용해 라우팅을 구현하며 Post 컴포넌트가 마크다운 파일들을 읽어와 각 페이지에서 보여주는 것까지 구현했다. 이제 마크다운 파일에서 그냥 텍스트를 불러오는 것이 아니라 html로 변환해서 사용자가 더 글을 읽기 편하도록 구현하는 것이 목표이다.</p>
<h2 style="color:white" node="[object Object]">gatsby-transformer-remark &amp; gatsby-source-filesystem</h2>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">마크다운 렌더링은 gatsby에서 제공하는 gatsby-transform-remark를 사용하면 쉽게 마크다운 렌더 기능을 구현할 수 있다. 하지만 gatsby에서는 파일을 여러개의 source로부터 갖고 오는 기능을 직접적으로 지원하지 않았고, 미리 source를 명시해   두어야 한다는 단점이 있었다.</p>
<h2 style="color:white" node="[object Object]">react-markdown</h2>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">결론적으로 <code style="color:darkcyan">gatsby-transformer-remark</code>를 제외하고 react에서 마크다운을 렌더링하는 방법을 찾아보았을 때 자주 사용되면서 최근까지도 업데이트가 계속된 <code style="color:darkcyan">react-markdown</code>이라는 패키지를 사용하기로 결정하였다. npm trends를 보면 지난 1년간 다운로드 수가 관련 패키지 중 가장 많은 것을 확인할 수 있다.</p>
<center>
<img src="https://raw.githubusercontent.com/bill0077/my-blog/gh-pages/post-contents/myblog-dev-log/media/react_markdown_downloads.png" width="100%" title="3d-rendering-test"/>
</center>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">설치하기 이전에 Github의 소개글을 읽어보자</p>
<div style="border-left:1vh cadetblue solid;background-color:#282828"><p style="margin-left:1vh;margin-right:1vh;color:#D0D0D0;font-size:2.5vh;line-height:150%" node="[object Object]">
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">This package is a React component that can be given a string of markdown that it’ll safely render to React elements.</p>
</p></div>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">즉 <code style="color:darkcyan">react-markdown</code>은 string을 마크다운 문법에 맞추어 react component로 렌더링 해주는 패키지이다. 설치 과정에서 어차피 gfm과 syntax highlighting까지 이용할 것이기 때문에 관련 패키지들도 함께 설치했다.</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-cmd" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>npm install react-markdown</span></code></div></pre>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">패키지 이용 자체는 매우 간단하다. <code style="color:darkcyan">Markdown</code>이라는 컴포넌트에 string을 마크다운 문법에 맞춰 넣어주면 이를 렌더링하여 해당 컴포넌트에서 볼 수 있게 된다. 예를 들어</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-js" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#cc7832">const</span><span> markdown </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#6a8759">&#x27;# Hi, *Pluto*!&#x27;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">Markdown</span><span class="token" style="color:#a9b7c6">&gt;</span><span class="token" style="color:#a9b7c6">{</span><span>markdown</span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#a9b7c6">/</span><span class="token maybe-class-name">Markdown</span><span class="token" style="color:#a9b7c6">&gt;</span></code></div></pre>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">위 예제는 아래와 같은 JSX와 동일하다.</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-jsx" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#e8bf6a">&lt;</span><span class="token" style="color:#e8bf6a">h1</span><span class="token" style="color:#e8bf6a">&gt;</span><span class="token plain-text">
</span><span class="token plain-text">  Hi, </span><span class="token" style="color:#e8bf6a">&lt;</span><span class="token" style="color:#e8bf6a">em</span><span class="token" style="color:#e8bf6a">&gt;</span><span class="token plain-text">Pluto</span><span class="token" style="color:#e8bf6a">&lt;/</span><span class="token" style="color:#e8bf6a">em</span><span class="token" style="color:#e8bf6a">&gt;</span><span class="token plain-text">!
</span><span class="token plain-text"></span><span class="token" style="color:#e8bf6a">&lt;/</span><span class="token" style="color:#e8bf6a">h1</span><span class="token" style="color:#e8bf6a">&gt;</span></code></div></pre>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">하지만 이 패키지  에서 렌더링 해주는 것은 h1, h2, blockquote와 같은 정말 기본적인 태그 뿐이므로, syntax highlighting 등의 기능을 위해서는 추가적인 플러그인이나 커스터마이징을 활용해 꾸며주는 작업이 필요하다. 따라서 해당 Markdown 컴포넌트에 각종 설정과 부가기능을 추가한 <code style="color:darkcyan">MarkdownRenderer</code> 컴포넌트를 만들어 추가해 주었다. 결과적으로 완성된 렌더러는 다음과 같다. 아래의 <code style="color:darkcyan">MarkdownRenderer</code> 컴포넌트는</p>
<ol>
<li style="color:#D0D0D0;font-size:2.5vh;line-height:150%" node="[object Object]">GFM extension 사용</li>
<li style="color:#D0D0D0;font-size:2.5vh;line-height:150%" node="[object Object]">syntax highlighting</li>
<li style="color:#D0D0D0;font-size:2.5vh;line-height:150%" node="[object Object]">마크다운 내부에서 HTML 태그 해석</li>
<li style="color:#D0D0D0;font-size:2.5vh;line-height:150%" node="[object Object]">frontmatter 해석</li>
</ol>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">4가지가 추가적으로 가능하도록 설정해주었다.</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-js" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// MarkdownRenderer.js</span><span>
</span><span></span><span class="token module" style="color:#cc7832">import</span><span> </span><span class="token imports maybe-class-name">React</span><span> </span><span class="token module" style="color:#cc7832">from</span><span> </span><span class="token" style="color:#6a8759">&#x27;react&#x27;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span></span><span class="token module" style="color:#cc7832">import</span><span> </span><span class="token imports maybe-class-name">Markdown</span><span> </span><span class="token module" style="color:#cc7832">from</span><span> </span><span class="token" style="color:#6a8759">&#x27;react-markdown&#x27;</span><span>
</span><span></span><span class="token module" style="color:#cc7832">import</span><span> </span><span class="token imports">rehypeRaw</span><span> </span><span class="token module" style="color:#cc7832">from</span><span> </span><span class="token" style="color:#6a8759">&#x27;rehype-raw&#x27;</span><span>
</span><span></span><span class="token module" style="color:#cc7832">import</span><span> </span><span class="token imports">remarkGfm</span><span> </span><span class="token module" style="color:#cc7832">from</span><span> </span><span class="token" style="color:#6a8759">&#x27;remark-gfm&#x27;</span><span>
</span><span></span><span class="token module" style="color:#cc7832">import</span><span> </span><span class="token imports">remarkFrontmatter</span><span> </span><span class="token module" style="color:#cc7832">from</span><span> </span><span class="token" style="color:#6a8759">&#x27;remark-frontmatter&#x27;</span><span>
</span><span></span><span class="token module" style="color:#cc7832">import</span><span> </span><span class="token imports" style="color:#a9b7c6">{</span><span class="token imports maybe-class-name">Prism</span><span class="token imports"> </span><span class="token imports module" style="color:#cc7832">as</span><span class="token imports"> </span><span class="token imports maybe-class-name">SyntaxHighlighter</span><span class="token imports" style="color:#a9b7c6">}</span><span> </span><span class="token module" style="color:#cc7832">from</span><span> </span><span class="token" style="color:#6a8759">&#x27;react-syntax-highlighter&#x27;</span><span>
</span>
<span></span><span class="token doc-comment" style="color:#808080">/** Renderer component that converts text into a React component according to Markdown format. */</span><span>
</span><span></span><span class="token module" style="color:#cc7832">export</span><span> </span><span class="token module" style="color:#cc7832">default</span><span> </span><span class="token" style="color:#cc7832">function</span><span> </span><span class="token maybe-class-name" style="color:#ffc66d">MarkdownRenderer</span><span class="token" style="color:#a9b7c6">(</span><span class="token parameter" style="color:#a9b7c6">{</span><span class="token parameter"> markdown </span><span class="token parameter" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>  </span><span class="token control-flow" style="color:#cc7832">return</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">Markdown</span><span> 
</span><span>      remarkPlugins</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#a9b7c6">{</span><span class="token" style="color:#a9b7c6">[</span><span>
</span><span>        remarkGfm</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#808080">// enables GFM extensions</span><span>
</span><span>        remarkFrontmatter </span><span class="token" style="color:#808080">// enables frontmatter</span><span>
</span><span>      </span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">}</span><span> 
</span><span>      rehypePlugins</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#a9b7c6">{</span><span class="token" style="color:#a9b7c6">[</span><span>rehypeRaw</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">}</span><span> </span><span class="token" style="color:#808080">// enables html tags inside markdown file</span><span>
</span><span>      components</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#a9b7c6">{</span><span class="token" style="color:#a9b7c6">%</span><span> raw </span><span class="token" style="color:#a9b7c6">%</span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">{</span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>        </span><span class="token" style="color:#ffc66d">code</span><span class="token" style="color:#a9b7c6">(</span><span class="token parameter">props</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span> </span><span class="token" style="color:#808080">// apply syntax highlighting inside code blocks</span><span>
</span><span>          </span><span class="token" style="color:#cc7832">const</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>children</span><span class="token" style="color:#a9b7c6">,</span><span> className</span><span class="token" style="color:#a9b7c6">,</span><span> node</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token spread" style="color:#a9b7c6">...</span><span>rest</span><span class="token" style="color:#a9b7c6">}</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> props
</span><span>          </span><span class="token" style="color:#cc7832">const</span><span> match </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token regex-delimiter" style="background:#364135">/</span><span class="token regex-source language-regex" style="background:#364135">language-(\w+)</span><span class="token regex-delimiter" style="background:#364135">/</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">exec</span><span class="token" style="color:#a9b7c6">(</span><span>className </span><span class="token" style="color:#a9b7c6">||</span><span> </span><span class="token" style="color:#6a8759">&#x27;&#x27;</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token" style="color:#808080">// find matching language</span><span>
</span><span>          </span><span class="token control-flow" style="color:#cc7832">return</span><span> match </span><span class="token" style="color:#a9b7c6">?</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span>
</span><span>            </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">SyntaxHighlighter</span><span>
</span><span>              </span><span class="token" style="color:#a9b7c6">{</span><span class="token spread" style="color:#a9b7c6">...</span><span>rest</span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>              </span><span class="token maybe-class-name">PreTag</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">&quot;div&quot;</span><span>
</span><span>              children</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#a9b7c6">{</span><span class="token known-class-name class-name">String</span><span class="token" style="color:#a9b7c6">(</span><span>children</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">replace</span><span class="token" style="color:#a9b7c6">(</span><span class="token regex-delimiter" style="background:#364135">/</span><span class="token regex-source language-regex" style="background:#364135">\n$</span><span class="token regex-delimiter" style="background:#364135">/</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#6a8759">&#x27;&#x27;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>              language</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#a9b7c6">{</span><span>match</span><span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6897bb">1</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>              </span><span class="token" style="color:#808080">/*style={dark}*/</span><span> </span><span class="token" style="color:#808080">// dark mode for code block </span><span>
</span><span>            </span><span class="token" style="color:#a9b7c6">/</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>          </span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span>
</span><span>            </span><span class="token" style="color:#a9b7c6">&lt;</span><span>code </span><span class="token" style="color:#a9b7c6">{</span><span class="token spread" style="color:#a9b7c6">...</span><span>rest</span><span class="token" style="color:#a9b7c6">}</span><span> className</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#a9b7c6">{</span><span>className</span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>              </span><span class="token" style="color:#a9b7c6">{</span><span>children</span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>            </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#a9b7c6">/</span><span>code</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>          </span><span class="token" style="color:#a9b7c6">)</span><span>
</span><span>        </span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>      </span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">{</span><span class="token" style="color:#a9b7c6">%</span><span> endraw </span><span class="token" style="color:#a9b7c6">%</span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>      </span><span class="token" style="color:#a9b7c6">{</span><span>markdown</span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#a9b7c6">/</span><span class="token maybe-class-name">Markdown</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">}</span></code></div></pre>
<h3 style="color:white" node="[object Object]">remarkPlugin</h3>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">일단 기본적인 렌더링에 더해 GFM을 사용할 수 있도록 remarkPlugin에 <code style="color:darkcyan">remarkGfm</code>을, 또 추후에 frontmatter을 이용해 제목이나 저자 등을 지정할 것이므로 <code style="color:darkcyan">remarkFrontmatter</code> 플러그인을 추가해주었다 (react-markdown에서 활용 가능한 플러그인은 <a to="https://github.com/remarkjs/remark/blob/main/doc/plugins.md#list-of-plugins에서" style="color:cadetblue;display:inline" href="https://github.com/remarkjs/remark/blob/main/doc/plugins.md#list-of-plugins%EC%97%90%EC%84%9C" node="[object Object]">https://github.com/remarkjs/remark/blob/main/doc/plugins.md#list-of-plugins에서</a> 확인 가능하다).</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-cmd" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>npm install remark-gfm
</span>npm install react-syntax-highlighter</code></div></pre>
<h3 style="color:white" node="[object Object]">rehypePlugin</h3>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">아래는 <code style="color:darkcyan">remarkPlugin</code>까지 적용한 이후 react-markdown을 이용해 렌더링을 하기 전과 후의 차이이다</p>
<center>
<img src="https://raw.githubusercontent.com/bill0077/my-blog/gh-pages/post-contents/myblog-dev-log/media/before_md_rendering.png" width="40%" title="routing-error"/>
<img src="https://raw.githubusercontent.com/bill0077/my-blog/gh-pages/post-contents/myblog-dev-log/media/after_md_rendering.png" width="40%" title="routing-error"/>
</center>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">그런데 렌더링을 적용한 경우에도 img 태그가 제대로 적용되지 않고 텍스트 그대로 나온 것을 볼 수 있는데, 이는 react-markdown의 기본 설정 때문이다. 기본적으로 react-markdown에서는 HTML 태그가 있으면 바로 <code style="color:darkcyan">skipHtml</code>을 이용해 건너뛰는데, 이러면 마크다운 내부에서 <code style="color:darkcyan">&lt;center&gt;</code>과  같은 태그를 활용해 정렬이 불가능하고 <code style="color:darkcyan">img</code> 태그 또한 모든 인자에 대한 설정을 추가해줘야 한다. 그러므로 HTML 태그를 그대로 해석하는 것을 허용하기 위해 rehypePlugins에 <code style="color:darkcyan">rehypeRaw</code>를 추가해주었다 <p style="color:white;display:inline;font-weight:bold" node="[object Object]">(⚠️react-markdown은 안전한 렌더링을 위해 마크다운 내부 HTML을 불허하는 것을 지향한다. 마크다운을 신뢰할 수 있는 경우에만 해당 플러그인을 활용하는 것을 추천한다⚠️).</p></p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-cmd" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>npm install rehype-raw</span></code></div></pre>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">이후 <code style="color:darkcyan">code</code>라는 컴포넌트에서 syntax highlighting이 가능하도록 추가해주면 (react-markdown의 예제 코드 참고) 기본적인 작업이 모두 종료된다.</p>
<h2 style="color:white" node="[object Object]">이미지 처리</h2>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">아직 문제가 있는데, 마크다운 내부 img 등 태그의 src는 개발 환경과 배포 환경에서 동일하게 사용하는 것이 불가능하다는 것이다. 링크의 url을 폴더 구조 그대로 사용하는 것이 아니기 때문에 상대경로를 이용한 참조 또한 불가능하다. 결론적으로 마크다운 내부에 이미지 파일 경로를 변수로 설정하고 개발 환경인지 배포 환경인지에 따라 이 변수를 다르게 설정해야 한다는 것인데, 이는 마크다운 내부의 문법으로는 불가능하다.</p>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">이를 해결하기 위해 간단하게 placeholder를 이용하기로 하였다. <code style="color:darkcyan">___MEDIA_FOLDER_PATH___</code> 의 형식으로 해당 마크다운이 참조하는 이미지 파일들의 폴더 위치를 지정한 상태에서 마크다운을 작성한 뒤 글 페이지 컴포넌트(Post.js)에서 마크다운을 렌더링하기 이전에 해당 placeholder를 환경에 맞는 값으로 치환해 주었다.</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-html" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">&lt;!--placeholder example--&gt;</span><span>
</span><span></span><span class="token" style="color:#e8bf6a">&lt;</span><span class="token" style="color:#e8bf6a">img</span><span class="token" style="color:#e8bf6a"> </span><span class="token" style="color:#a9b7c6">src</span><span class="token attr-equals" style="color:#a5c261">=</span><span class="token" style="color:#a5c261">&quot;</span><span class="token" style="color:#a5c261">https://raw.githubusercontent.com/bill0077/my-blog/gh-pages/post-contents/myblog-dev-log/media/image_resolved.png</span><span class="token" style="color:#a5c261">&quot;</span><span class="token" style="color:#e8bf6a"> </span><span class="token" style="color:#a9b7c6">width</span><span class="token attr-equals" style="color:#a5c261">=</span><span class="token" style="color:#a5c261">&quot;</span><span class="token" style="color:#a5c261">100%</span><span class="token" style="color:#a5c261">&quot;</span><span class="token" style="color:#e8bf6a"> </span><span class="token" style="color:#a9b7c6">title</span><span class="token attr-equals" style="color:#a5c261">=</span><span class="token" style="color:#a5c261">&quot;</span><span class="token" style="color:#a5c261">image_resolved</span><span class="token" style="color:#a5c261">&quot;</span><span class="token" style="color:#e8bf6a">/&gt;</span></code></div></pre>
<h2 style="color:white" node="[object Object]">결과물</h2>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">최종적으로 렌더링된 결과는 아래와 같다. 폰트나 인용문 등은 추후에 더 가독성 있도록 꾸며주도록 하겠다.</p>
<center>
<img src="https://raw.githubusercontent.com/bill0077/my-blog/gh-pages/post-contents/myblog-dev-log/media/image_resolved.png" width="100%" title="image_resolved"/>
</center>
<br/>
<br/>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]"><p style="color:white;display:inline;font-weight:bold" node="[object Object]">P.S.</p> 공식 docs에서 Markdown을 사용하라는 것과는 다르게 다른 블로그 글들을 보면 ReactMarkdown이라는 이름의 컴포넌트를 사용하는 경우가 굉장히 많은데, git history를 뒤져보니 이는 컴포넌트 이름이 계속 변경되어서 그렇다. ReactMarkdown이라는 이름은 6.0.0 ~ 9.0.0 사이 버전에서 잠깐 사용되다가 약 5개월 전(Sep 27, 2023에 commit) 9.0.0 버전에서 다시 Markdown을 사용하도  록 리팩토링 되었다. 왜 이름이 다시 롤백되었는지 명확한 이유는 모르겠으나 어쨌든 두 이름 모두 확인한 범주 이내에서는 정상적으로 동작하므로 큰 문제는 없을 것 같다.</p>
<h1 style="color:white;border-bottom:solid" node="[object Object]">reference</h1>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">remarkjs, react-markdown : <a to="https://github.com/remarkjs/react-markdown" style="color:cadetblue;display:inline" href="https://github.com/remarkjs/react-markdown" node="[object Object]">https://github.com/remarkjs/react-markdown</a></p>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">npm trends, react-markdown vs remark vs remark-react: <a to="https://npmtrends.com/react-markdown-vs-remark-vs-remark-react" style="color:cadetblue;display:inline" href="https://npmtrends.com/react-markdown-vs-remark-vs-remark-react" node="[object Object]">https://npmtrends.com/react-markdown-vs-remark-vs-remark-react</a></p>
<p style="color:#D0D0D0;font-size:2.5vh;line-height:160%" node="[object Object]">mia.log, react-markdown 사용하기: <a to="https://velog.io/@mia/react-markdown-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" style="color:cadetblue;display:inline" href="https://velog.io/@mia/react-markdown-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" node="[object Object]">https://velog.io/@mia/react-markdown-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0</a></p></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/myblog-dev-log/adding-markdown-renderer/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-4dcf80b3ec3c1d7e90c0.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-4ec131227afe6d26b02a.js\"],\"component---src-pages-toy-projects-solar-system-js\":[\"/component---src-pages-toy-projects-solar-system-js-26c2bfa09265e4bde8c7.js\"],\"component---src-templates-post-js\":[\"/component---src-templates-post-js-1e0638dc97f9811b5b4b.js\"],\"component---src-templates-post-list-js\":[\"/component---src-templates-post-list-js-7f0c417f55c0bb11f326.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="bf84e23dddaa824c8654";</script><script src="/my-blog/webpack-runtime-78e8db40ba63a1f896dc.js" async></script><script src="/my-blog/framework-421aea1a5abe8c38ff0e.js" async></script><script src="/my-blog/app-4dcf80b3ec3c1d7e90c0.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>